---
layout: post
date: 2015-08-03T14:02:12+09:00
title: Infrastructure as codeにおいて，もう少しだけ，よりよいコミットメッセージを書くために
draft: true
tags:
- git
- opinion
---
※あらゆる開発ではこの通りでは無いことをご理解ください

Gitのcommit log，それからPull Requestとレビューについて最近思うことがあって，Slackで友人に語ったところ，ブログに書いてみることを提案された．

## そもそもcommit logという「単位」は何を指しているのか

DBにもcommitはあるのでコンテキストにも依るが，

## 

個人的に以下のようなコミットは止めたほうがいいと思っている．

```
commit abcdefghijklmnopqrstuvwxyz0123456789abcd
Author: Takahiro OKUMURA <hfm.garden@gmail.com>
Date:   Sun Mar 8 00:23:47 2015 +0900

    ref: http://url.to/other_commit_hash_or_github_issue
```

ref: http://url.to/other_commit_hash_or_github_issue

> 話ズレるかもしれないんですが，僕はコミットメッセージ主義なので，コミットメッセージに「ref」だけで済ますのは微妙と思ってます
> （PRにちゃんと書けばいい，には否定的．だったらコミットメッセージにちゃんと書いて，PRはコピペすればいい）．
>
> メッセージだけを見たらすべてが分かるようになっているのが好ましいです．
>
> 以下，理由：
>
> - あっちこっちのリンクに飛ばされるのはレビューする側の負担になる
>   - コンテキストの増加はつらい
>   - レビューする側に余計な負担を貸すと，レビュー品質の低下（リスクの増加）に繋がってしまうので，なるべく負担を減らしたい
> - リンク先がずっと生きてる保証なんて無い
>   - GitHubからGH:Eに移行して消滅したリンクが大量にあるはず
> ローカルで commit をまとめて綺麗にしてから git push -f origin という感じでしょうか
> 色々ケースがあると思うので，一様に対応できるものでは無いんじゃないですかね．
> push直後に「あ！」ってなったなら，commit --amendしてすぐforce pushすればいいですし．
>
> レビューが進んでいくなかで見つかった問題は「バグ・不具合・変更漏れ」ですよね．
> ということは，もうそれは「fix」に状況が変わってしまっているので，手を加えず次のコミットを積み上げて解決するしか無いと思います．
>
> その際，「コミットabcdefghでこういう変更いれたんだけど，やっぱまずかったわー」みたいにコミット同士のリンクを作って理由書いておくと良いのでは無いでしょうか．
> githubからgh:eのように環境移行しても，commit同士のリンクなら残りやすいでしょう．

こうしたcommitの粒度やレビューの仕方については定期的に蒸し返される印象はある．
けど，数年立てば組織人材も新陳代謝するので，継続的に啓蒙されるべき内容ではあると思う．
